(this["webpackJsonpshopify-intern-challenge-w2021"]=this["webpackJsonpshopify-intern-challenge-w2021"]||[]).push([[0],{62:function(e,t,n){e.exports=n(81)},79:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var a=n(3),o=n.n(a),i=n(57),r=n(16),c=n(58),l=n(22),s=n(38);function m(){var e=Object(s.a)(['\n  query SEARCH {\n    result(s: $search) @rest(path: "/?apikey=','&type=movie&{args}") {\n      Search {\n        Title\n        Year\n        imdbID\n        Type\n        Poster\n      }\n    }\n  }\n']);return m=function(){return e},e}function u(){var e=Object(s.a)(['\n  query GET_TITLE {\n    title(t: $title, i: $id) @rest(path: "/?apikey=','&type=movie&{args}") {\n      Title\n      Year\n      imdbID\n      Type\n      Poster\n    }\n  }\n']);return u=function(){return e},e}var d=Object(r.gql)(u(),"889b279c"),b=Object(r.gql)(m(),"889b279c"),p=function(e){var t=indexedDB.open("Shoppies");t.onsuccess=function(){var n=t.result.transaction("nominations","readwrite").objectStore("nominations");n.clear(),e.forEach((function(e){n.add(e)}))}};function h(){var e=Object(a.useState)("..."),t=Object(l.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)([]),s=Object(l.a)(c,2),m=s[0],u=s[1],h=Object(r.useLazyQuery)(b),f=Object(l.a)(h,2),E=f[0],N=f[1],j=N.loading,S=N.data,O=Object(r.useApolloClient)();return Object(a.useEffect)((function(){var e=window.location.search,t=new URLSearchParams(e);if(t.has("nominations")){var n=[],a=t.get("nominations").split(",");a.forEach((function(e){!function(e,t){var n=indexedDB.open("Shoppies",1);n.onupgradeneeded=function(){var e=n.result;e.objectStoreNames.contains("nominations")||e.createObjectStore("nominations",{keyPath:"imdbID"})},n.onsuccess=function(){var a=n.result.transaction("nominations","readonly").objectStore("nominations").get(e);a.onsuccess=function(){var e=a.result;t(e)},a.onerror=function(){t(null)}}}(e,(function(t){if(t){if(n.push(t),n.length===a.length){p(n),u(n);var o=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({},document.title,o)}}else O.query({query:d,variables:{id:e}}).then((function(e){var t=e.data.title;if(n.push(t),n.length===a.length){p(n),u(n);var o=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({},document.title,o)}}))}))}))}else!function(e){var t=indexedDB.open("Shoppies",1);t.onupgradeneeded=function(){var e=t.result;e.objectStoreNames.contains("nominations")||e.createObjectStore("nominations",{keyPath:"imdbID"})},t.onsuccess=function(){var n=t.result.transaction("nominations","readonly").objectStore("nominations").getAll();n.onsuccess=function(){var t=n.result;e(t)}}}((function(e){return u(e)}))}),[O]),o.a.createElement("div",{className:"controller"},o.a.createElement(y,{nominationList:m}),o.a.createElement(v,{setTitle:i,searchTitle:E}),o.a.createElement(g,{title:n,searchData:S,loading:j,nominationList:m,setNominationList:u}),o.a.createElement(w,{nominationList:m,setNominationList:u}))}var f=n(60);function v(e){var t=e.setTitle,n=e.searchTitle,i=Object(a.useCallback)(Object(f.debounce)((function(e){(e=e.trim()).length<1||(n({variables:{search:e}}),t(e))}),300),[]);return o.a.createElement("div",{className:"card mb-4"},o.a.createElement("div",{className:"card-body"},o.a.createElement("label",{className:"font-weight-bold",htmlFor:"SearchBar"},"Movie Title"),o.a.createElement("div",{className:"input-group"},o.a.createElement("div",{className:"input-group-prepend"},o.a.createElement("img",{className:"input-group-text",src:"search.svg",alt:"Seach Icon","aria-hidden":!0})),o.a.createElement("input",{type:"text",className:"form-control",id:"SearchBar",onKeyUp:function(e){return i(e.currentTarget.value)}}))))}var E=n(61);function g(e){var t,n=e.title,a=e.searchData,i=e.loading,r=e.nominationList,c=e.setNominationList;return i?o.a.createElement("div",{className:"card mb-4"},o.a.createElement("div",{className:"card-body"},o.a.createElement("p",{className:"font-weight-bold"},'Results for "',n,'"'),o.a.createElement("div",{className:"text-center mt-4 mb-4"},o.a.createElement("div",{className:"spinner-border",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading..."))))):void 0===a?o.a.createElement(o.a.Fragment,null):null===a.result.Search?o.a.createElement("div",{className:"card mb-4"},o.a.createElement("div",{className:"card-body"},o.a.createElement("p",{className:"font-weight-bold"},'Results for "',n,'"'),o.a.createElement("p",null,"Sorry, the search didn't find anything."))):(t=a.result.Search,o.a.createElement("div",{className:"card mb-4"},o.a.createElement("div",{className:"card-body"},o.a.createElement("p",{className:"font-weight-bold"},'Results for "',n,'"'),o.a.createElement("ul",null,t.map((function(e){return o.a.createElement("li",{key:e.imdbID,className:"mb-1"},e.Title," (",e.Year,")",o.a.createElement("button",{type:"button",className:"btn btn-light ml-2",onClick:function(){return function(e){var n=t.find((function(t){return t.imdbID===e})),a=[].concat(Object(E.a)(r),[n]);c(a),p(a)}(e.imdbID)},disabled:void 0!==r.find((function(t){return t.imdbID===e.imdbID}))||r.length>=5},"Nominate"))}))))))}function w(e){var t=e.nominationList,n=e.setNominationList,i=Object(a.useState)("Get shareable link"),r=Object(l.a)(i,2),c=r[0],s=r[1];return t.length<1?o.a.createElement(o.a.Fragment,null):o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-body"},o.a.createElement("p",{className:"font-weight-bold"},"Nominations"),o.a.createElement("ul",null,t.map((function(e){return o.a.createElement("li",{key:e.imdbID,className:"mb-1"},e.Title," (",e.Year,")",o.a.createElement("button",{type:"button",className:"btn btn-light ml-2",onClick:function(){return function(e){var a=t.filter((function(t){return t.imdbID!==e}));n(a),p(a)}(e.imdbID)}},"Remove"))}))),o.a.createElement("button",{className:"btn btn-outline-primary",onClick:function(){var e=t.map((function(e){return e.imdbID})),n=window.location.protocol+"//"+window.location.host+window.location.pathname,a="?nominations=".concat(e.join(","));navigator.clipboard.writeText("".concat(n).concat(a)),s("Link saved to clipboard!")},onMouseLeave:function(){return s("Get shareable link")}},c)))}function y(e){var t=e.nominationList;return t.length<5?o.a.createElement(o.a.Fragment,null):o.a.createElement("div",{className:"alert alert-primary",role:"alert"},"You've nominated ",t.length," movies!")}n(78),n(79);function N(){var e=new c.RestLink({uri:"http://omdbapi.com"}),t=new r.ApolloClient({cache:new r.InMemoryCache,link:e});return o.a.createElement(r.ApolloProvider,{client:t},o.a.createElement("div",{className:"container",style:{marginTop:"60px",marginBottom:"60px"}},o.a.createElement("h1",null,"The Shoppies"),o.a.createElement(h,null)))}Object(i.render)(o.a.createElement(N,null),document.getElementById("root"))}},[[62,1,2]]]);
//# sourceMappingURL=main.aba47d1f.chunk.js.map